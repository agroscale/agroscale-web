# WOFOST

## Introduction 

WOFOST is a computer model that simulates growth and development of annual field crops [De Wit et al., 2019](https://www.sciencedirect.com/science/article/pii/S0308521X17310107?via%3Dihub). It can be used to estimate potential crop productivity for a given variety, and under specified soil and weather conditions. Such estimates are the basis for the assessment of options for regional agricultural production, or can be used for the analysis of variability and trends in crop yields.

In this chapter we explain *how* to use WOFOST, but we only provide very scant information on the concepts or algorithms on which the model is based. See [this document](https://wofost.readthedocs.io/en/latest/_downloads/3c9337e7ab23207e5a5819689c79a889/WOFOST_system_description.pdf) for a detailed description of how WOFOST works. 

Like all models, WOFOST is a simplification of reality. In practice, crop yield is a result of the interaction of many ecological and crop management factors. In WOFOST, only a number of these are considered. It is thus very important to understand which these are. 

With WOFOST, you can calculate potential and water-limited production. In the current version, nutrient-limited production and yield reducing factors are not taken into account. In each model run, WOFOST simulates the growth of a specific crop, given the selected soil and weather data. For each simulation, you must select specific boundary conditions, which comprise, amongst others, of the crop planting date and the  soil's water status. 

Crop growth is simulated using daily weather data of many years and different parameters for each relevant soil type within a region.

Variation in timing of crop production can be taken into account by varying the starting date of the growing season and/or by choosing crop varieties with different growth duration. 

## Chapter requirements

We use *R* package `Rwofost`. It has been submitted to CRAN (March 2020), so pretty soon you should be able  [install](/installation.html) it from there.


## Example run

### Weather data
 
To run WOFOST, you need daily weather data. 

```{r wofost_0}
library(Rwofost)
f <- system.file("extdata/Netherlands_Swifterbant.csv", package="meteor")
w <- read.csv(f)
w$date <- as.Date(w$date)
head(w)
```

Here we use an example file that comes with *R*. You can use any source of weather data you want (and deem reliable), but you have to create a `data.frame` with the following column names: `r paste(colnames(w), collapse=" ,")`. All variables should be numeric, except `date` which should contain `Date`s. We discuss weather data sources in the [next chapter](spatial-wofost.html) and also in the section on (spatial data)[/data/spatial/index.html]. 

### Crop parameters

A crop variety is described by a (rather lengthy) set of parameters. The `Rwofost` package comes with a set of examples that you can use or build on. 

```{r wofost_10}
print(wofost_crop())
```

Let's take barley

```{r wofost_11}
crop <- wofost_crop("barley")
str(crop)
```

The object `crop` is a `list` with `r length(crop)` elements. Most are single numbers, but there are also two-row matrices


## Soil parameters

```{r wofost_20}
soil <- wofost_soil('ec1')
str(soil)
```


## Control parameters

```{r wofost_30}
contr <- wofost_control()
str(contr)
contr$modelstart <- as.Date("1976-02-06")
```

## Create model
```{r wofost_42}
w <- wofost_model(crop, w, soil, contr)
```

## Run model 

```{r wofost_45}
d <- run(w)
```


## Inspect output

```{r wofost_50}
head(d)
tail(d)
plot(d[,'step'], d[, 'LAI'])
```


